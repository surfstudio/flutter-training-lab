# üåê –õ–†4: –†–∞–±–æ—Ç–∞ —Å —Å–µ—Ç—å—é

## üîÑ –≠–≤–æ–ª—é—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –Ω–∞—à–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

–í –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö —Ä–∞–±–æ—Ç–∞—Ö –º—ã —Å–æ–∑–¥–∞–ª–∏ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –º–µ—Å—Ç —Å –∫—Ä–∞—Å–∏–≤–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π. 

---

### ‚ö†Ô∏è –¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞

–°–µ–π—á–∞—Å –Ω–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ** –∏–∑ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (`assets/json/places.json`). –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:

> **üö® –ü—Ä–æ–±–ª–µ–º—ã —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:**
> - üìÅ –î–∞–Ω–Ω—ã–µ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω—ã –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ - –Ω–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
> - üîÑ –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –±–µ–∑ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è  
> - üåç –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
> - üìä –ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–æ–±–∏—Ä–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∏ –º–µ—Ç—Ä–∏–∫–∏
> - üè∑Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –ø–æ —Ä–∞–±–æ—Ç–µ —Å –¥–∞–Ω–Ω—ã–º–∏

## üéØ –ß—Ç–æ –º—ã –±—É–¥–µ–º —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å

–¢–µ–ø–µ—Ä—å –ø—Ä–∏—à–ª–æ –≤—Ä–µ–º—è –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –Ω–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ **–ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ä–≤–µ—Ä–Ω—ã–º API:

### üìã –≠—Ç–∞–ø—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

|| –≠—Ç–∞–ø | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----------|----------|
|| 1Ô∏è‚É£ | **HTTP-–∫–ª–∏–µ–Ω—Ç** | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Dio –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ |
|| 2Ô∏è‚É£ | **API –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** | –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ —Å Retrofit |
|| 3Ô∏è‚É£ | **DTO –º–æ–¥–µ–ª–∏** | –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è JSON-–¥–∞–Ω–Ω—ã—Ö |
|| 4Ô∏è‚É£ | **Repository –ø–∞—Ç—Ç–µ—Ä–Ω** | –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ |
|| 5Ô∏è‚É£ | **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ UI** | –°–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏, –æ—à–∏–±–∫–∏ –∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ |

---

> üí° **–í–∞–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å:** –†–∞–±–æ—Ç–∞ —Å —Å–µ—Ç—å—é - —ç—Ç–æ –æ–¥–∏–Ω –∏–∑ **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã—Ö –Ω–∞–≤—ã–∫–æ–≤** –≤ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –º–æ–±–∏–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ. –û—Ç –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–≤–∏—Å–∏—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç.

üìñ **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã:**
- [HTTP –∫–ª–∏–µ–Ω—Ç—ã –≤–æ Flutter](https://docs.flutter.dev/networking/http)
- [–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Dio](https://pub.dev/packages/dio)

---

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–æ–±–∏–ª—å–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–µ—Ç–µ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Å–µ—Ä–≤–µ—Ä–Ω—ã–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏.

# üó∫Ô∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Ç—å—é –≤–æ Flutter

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å —Å–µ—Ç–µ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –≤ Flutter –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.

## üèóÔ∏è –ú–Ω–æ–≥–æ—Å–ª–æ–π–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–í –Ω–∞—à–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:

```
UI Layer (Widgets/Pages)
     ‚Üì
Business Logic Layer (Models)  
     ‚Üì
Repository Layer (PlacesRepository)
     ‚Üì
Data Layer (ApiClient ‚Üí HTTP Client ‚Üí Server)
```

### üéØ –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–≥–æ —Å–ª–æ—è:

|| –°–ª–æ–π | –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å | –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ |
|------|------|-------------|---------------------|
|| **üé® UI Layer** | –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ | Widgets, Pages, Screens |
|| **üß† Business Logic** | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è | Models |
|| **üì¶ Repository** | –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö | Repository, Mappers, Converters |  
|| **üåê Data Layer** | –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ HTTP-–∑–∞–ø—Ä–æ—Å—ã | ApiClient, DTO, NetworkClient |

---

## üîß HTTP-–∫–ª–∏–µ–Ω—Ç—ã –≤–æ Flutter

–í–æ Flutter –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å HTTP:

|| –†–µ—à–µ–Ω–∏–µ | –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ | –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è |
|---------|-------------|-------------|-----------------|
|| **[http](https://pub.dev/packages/http)** | üîµ Dart Team | ‚Ä¢ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –≤ Flutter<br>‚Ä¢ –ü—Ä–æ—Å—Ç–æ–π API<br>‚Ä¢ –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å | üöÄ –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã |  
|| **[dio](https://pub.dev/packages/dio)** | –°–æ–æ–±—â–µ—Å—Ç–≤–æ | ‚Ä¢ Interceptors<br>‚Ä¢ –î–µ—Ç–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫<br>‚Ä¢ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ | üè¢ –ü—Ä–æ–¥–∞–∫—à–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |
|| **[chopper](https://pub.dev/packages/chopper)** | –°–æ–æ–±—â–µ—Å—Ç–≤–æ | ‚Ä¢ Retrofit-—Å—Ç–∏–ª—å<br>‚Ä¢ –ö–æ–¥–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è<br>‚Ä¢ –°–ª–æ–∂–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ | üîß –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ |

### üéØ –ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ Dio?

–í –Ω–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **Dio** –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –ø—Ä–∏—á–∏–Ω–∞–º:

<details>
<summary>‚úÖ <strong>–ü–ª—é—Å—ã Dio</strong></summary>

- üîß **–ú–æ—â–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** —Ç–∞–π–º–∞—É—Ç–æ–≤ –∏ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- üìù **Interceptors** –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤
- üö® **–î–µ—Ç–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** —Å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –ø—Ä–æ–±–ª–µ–º
- üîÑ **Retry –º–µ—Ö–∞–Ω–∏–∑–º—ã** –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ 
- üóÑÔ∏è **–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è**
- üåê **–†–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–∫—Å–∏** –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞–º–∏

</details>

<details>
<summary>‚ùå <strong>–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –º–∏–Ω—É—Å—ã</strong></summary>

- üì¶ **–ë–æ–ª—å—à–∏–π —Ä–∞–∑–º–µ—Ä** –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å http –ø–∞–∫–µ—Ç–æ–º
- üìà **–ö—Ä–∏–≤–∞—è –æ–±—É—á–µ–Ω–∏—è** –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- ‚öôÔ∏è **–¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π

</details>

---

# üîç –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞

–î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ —Å–µ–π—á–∞—Å –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ –Ω–∞—à–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:

### üìÅ ApiClientFromAssets - —Ç–µ–∫—É—â–∏–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö

–°–µ–π—á–∞—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `ApiClientFromAssets` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:

```dart
final class ApiClientFromAssets implements ApiClient {
  const ApiClientFromAssets();

  @override
  Future<List<PlaceDto>> getPlaces() async {
    final jsonString = await rootBundle.loadString('assets/json/places.json');
    final List<dynamic> jsonData = json.decode(jsonString);
    return jsonData.map((json) => PlaceDto.fromJson(json)).toList();
  }

  @override
  Future<List<PlaceDto>> getFilteredPlaces({required FilterPlacesRequestDto filter}) async {
    final allPlaces = await getPlaces();
    // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ª–æ–∫–∞–ª—å–Ω–æ
    return _filterPlaces(allPlaces, filter);
  }
}
```

> **üö® –ü—Ä–æ–±–ª–µ–º—ã —Ç–∞–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:**
> - üìä –î–∞–Ω–Ω—ã–µ –Ω–µ –∞–∫—Ç—É–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –º–æ–∂–µ—Ç —É—Å—Ç–∞—Ä–µ—Ç—å
> - üåê –ù–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º
> - üìà –ù–µ–≤–æ–∑–º–æ–∂–Ω–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
> - üîÑ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏

### üèóÔ∏è PlacesRepository - –≥–æ—Ç–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–í –ø—Ä–æ–µ–∫—Ç–µ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å Repository –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º:

```dart
final class PlacesRepository extends BaseRepository implements IPlacesRepository {
  final ApiClient _apiClient; // –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö  
  final IPlaceResponseConverter _placeResponseConverter; // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è DTO -> Entity

  @override
  RequestOperation<List<PlaceEntity>> getPlaces() => 
    makeApiCall(() async {
      final data = await _apiClient.getPlaces();
      return _placeResponseConverter.convertMultiple(data).toList();
    });
}
```

**–ß—Ç–æ –º—ã –≤–∏–¥–∏–º:**
- ‚úÖ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è –ª—é–±–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- üîÑ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è `ApiClient` - –ª–µ–≥–∫–æ –∑–∞–º–µ–Ω–∏—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é
- üõ°Ô∏è –ë–∞–∑–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ `BaseRepository.makeApiCall()`
- üóÑÔ∏è –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –º–µ–∂–¥—É —Å–ª–æ—è–º–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### üéØ –ü—É—Ç—å –∫ —É–ª—É—á—à–µ–Ω–∏—é

–ù–∞—à–∞ –∑–∞–¥–∞—á–∞ - –∑–∞–º–µ–Ω–∏—Ç—å `ApiClientFromAssets` –Ω–∞ `ApiClientRemote` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º API:

1. ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Dio HTTP-–∫–ª–∏–µ–Ω—Ç
2. üì° –°–æ–∑–¥–∞—Ç—å Retrofit API –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å  
3. üîÑ –ü–æ–¥–∫–ª—é—á–∏—Ç—å –Ω–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ
4. üé® –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –≤ UI

---

# üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ç–µ–≤–æ–≥–æ —Å–ª–æ—è

## üéõÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è HTTP-–∫–ª–∏–µ–Ω—Ç–∞

–°–æ–∑–¥–∞–Ω–∏–µ HTTP-–∫–ª–∏–µ–Ω—Ç–∞ –≤—ã–Ω–µ—Å–µ–Ω–æ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å `AppDioConfigurator`:

```dart
class AppDioConfigurator {
  const AppDioConfigurator();

  Dio create({
    required Iterable<Interceptor> interceptors,
    required String url,
    String? proxyUrl,
  }) {
    const timeout = Duration(seconds: 30);

    final dio = Dio();

    // –ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
    dio.options
      ..baseUrl = url
      ..connectTimeout = timeout
      ..receiveTimeout = timeout
      ..sendTimeout = timeout;

    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
    (dio.httpClientAdapter as IOHttpClientAdapter).createHttpClient = () {
      final client = HttpClient();
      if (proxyUrl != null && proxyUrl.isNotEmpty) {
        client
          ..findProxy = (uri) => 'PROXY $proxyUrl'
          ..badCertificateCallback = (_, __, ___) => true;
      }
      return client;
    };

    dio.interceptors.addAll(interceptors);

    return dio;
  }
}
```

### üîß –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

|| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|------------|
|| **baseUrl** | `http://localhost:8888` | –ë–∞–∑–æ–≤—ã–π –∞–¥—Ä–µ—Å API —Å–µ—Ä–≤–µ—Ä–∞ |
|| **timeout** | `30 —Å–µ–∫—É–Ω–¥` | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è |
|| **interceptors** | `[]` | –ü–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ |
|| **proxyUrl** | `optional` | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ |

---

## üì° API –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

–í—Å–µ URL —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –∫–ª–∞—Å—Å–µ:

```dart
class ApiUrls {
  static const String baseUrl = 'http://localhost:8888';
  static const String places = '/place';
  static const String placeDetails = '/place/{placeId}';
  static const String filteredPlaces = '/filtered_places';
  static const String uploadFile = '/upload_file';

  const ApiUrls._();
}
```

> üí° **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ç–∞–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:**
> - üéØ –í—Å–µ URL –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
> - üîÑ –õ–µ–≥–∫–æ –∏–∑–º–µ–Ω–∏—Ç—å –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞
> - üß™ –ü—Ä–æ—Å—Ç–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É dev/prod –æ–∫—Ä—É–∂–µ–Ω–∏—è–º–∏

---

## üèóÔ∏è Retrofit API –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

–î–ª—è –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ **Retrofit**:

```dart
@RestApi()
abstract class ApiClientRemote implements ApiClient {
  factory ApiClientRemote(Dio dio, {String baseUrl}) = _ApiClientRemote;

  @override
  @GET(ApiUrls.places)
  Future<List<PlaceDto>> getPlaces();

  @override
  @POST(ApiUrls.filteredPlaces)
  Future<List<PlaceDto>> getFilteredPlaces({
    @Body() required FilterPlacesRequestDto filter
  });

  @GET(ApiUrls.placeDetails)
  Future<PlaceDto> getPlaceDetails(@Path() int placeId);

  @POST(ApiUrls.uploadFile)
  @MultiPart()
  Future<String> uploadFile(@Part() File file);
}
```

### üìö –ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ Retrofit:

|| –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è |
|-----------|------------|---------------------|
|| **@GET/@POST** | HTTP –º–µ—Ç–æ–¥—ã | `@GET('/places')` |
|| **@Body()** | –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ | `@Body() FilterDto filter` |
|| **@Path()** | –ü–∞—Ä–∞–º–µ—Ç—Ä –≤ URL | `@Path() int id` –¥–ª—è `/place/{id}` |
|| **@Query()** | Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã | `@Query() String search` –¥–ª—è `?search=value` |
|| **@MultiPart()** | –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ | –î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π |

> ‚öôÔ∏è **–í–∞–∂–Ω–æ:** Retrofit –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –≤ —Ñ–∞–π–ª–µ `api_client_remote.g.dart` —á–µ—Ä–µ–∑ `build_runner`

---

## üìÑ DTO –º–æ–¥–µ–ª–∏ –∏ JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å JSON –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è DTO (Data Transfer Object) –º–æ–¥–µ–ª–∏:

```dart
@JsonSerializable(createToJson: false)
class PlaceDto {
  final String description;
  final double? distance;
  final int id;
  @JsonKey(name: 'urls')
  final List<String> images;
  final double lat;
  @JsonKey(name: 'lng')  
  final double lon;
  final String name;
  final PlaceTypeDto placeType;

  const PlaceDto({
    required this.id,
    required this.name,
    required this.description,
    required this.placeType,
    required this.images,
    required this.lat,
    required this.lon,
    this.distance,
  });

  factory PlaceDto.fromJson(Map<String, dynamic> json) => _$PlaceDtoFromJson(json);
}
```

### üîë –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏:

|| –ê–Ω–Ω–æ—Ç–∞—Ü–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
|-----------|------------|--------|
|| **@JsonSerializable()** | –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–≤ | `createToJson: false` - —Ç–æ–ª—å–∫–æ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è |
|| **@JsonKey(name: '...')** | –ú–∞–ø–ø–∏–Ω–≥ –ø–æ–ª–µ–π | `@JsonKey(name: 'lng')` –¥–ª—è `lon` |
|| **factory fromJson()** | –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∏–∑ JSON | –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |


## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ - –æ—Å–Ω–æ–≤—ã

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Å–µ—Ç—å—é –Ω–µ–∏–∑–±–µ–∂–Ω–æ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –æ—à–∏–±–∫–∏. –í –Ω–∞—à–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –µ—Å—Ç—å –±–∞–∑–æ–≤—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∏:

### üõ°Ô∏è –ë–∞–∑–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥

```dart
abstract base class BaseRepository {
  @protected
  RequestOperation<T> makeApiCall<T>(AsyncValueGetter<T> call) async {
    try {
      final data = await call();
      return Result.ok(data);
    } on DioException catch (e, s) {
      // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫
      return Result.failed(/* –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ */, s);
    } on Object catch (e, s) {
      return Result.failed(UnknownFailure(message: e.toString()), s);
    }
  }
}
```

### üéØ –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã –ø—Ä–æ–±–ª–µ–º:

| –¢–∏–ø –ø—Ä–æ–±–ª–µ–º—ã | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------------|----------|
| **–ù–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞** | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ñ–ª–∞–π–Ω |
| **–¢–∞–π–º–∞—É—Ç —Å–µ—Ä–≤–µ—Ä–∞** | –°–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç |
| **–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞** | –ü—Ä–æ–±–ª–µ–º—ã –Ω–∞ –±–µ–∫–µ–Ω–¥–µ |
| **–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞** | –î—Ä—É–≥–∏–µ –ø—Ä–æ–±–ª–µ–º—ã |

---

## üì¶ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Repository

Repository –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `makeApiCall()` –¥–ª—è —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫:

```dart
final class PlacesRepository extends BaseRepository implements IPlacesRepository {
  final ApiClient _apiClient;
  final IPlaceResponseConverter _placeResponseConverter;

  @override
  RequestOperation<List<PlaceEntity>> getPlaces() => 
    makeApiCall(() async {
      final data = await _apiClient.getPlaces();
      return _placeResponseConverter.convertMultiple(data).toList();
    });
}
```

**üîß –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ `makeApiCall()` - –±–∞–∑–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- üîÑ `Converters` - –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ DTO ‚Üî Entity  
- üìä `RequestOperation<T>` - —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å –æ—à–∏–±–∫–∞–º–∏

---

# üé® –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å UI —Å–ª–æ–µ–º

–ü–æ—Å–ª–µ–¥–Ω–∏–π —ç—Ç–∞–ø - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É:

## üß† Model —Å —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ –∑–∞–≥—Ä—É–∑–∫–∏

```dart
class PlacesModel implements IPlacesModel {
  final PlacesRepository _repository;
  final _placesState = ValueNotifier<PlacesState>(PlacesState.loading());

  PlacesModel(this._repository);

  @override
  ValueListenable<PlacesState> get placesStateListenable => _placesState;

  @override
  Future<void> loadPlaces({FilterPlacesEntity? filter}) async {
    _placesState.value = PlacesState.loading(); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
    
    final result = await _repository.getPlaces(
      filter: filter ?? await _repository.getSavedFilter()
    );

    switch (result) {
      case ResultOk(:final data):
        _placesState.value = PlacesState.loaded(data);
      case ResultFailed(:final error):
        _placesState.value = PlacesState.error(_mapErrorToMessage(error));
    }
  }

  String _mapErrorToMessage(Failure error) {
    return switch (error) {
      NoNetworkFailure() => '–ù–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É',
      ServerNotRespondingFailure() => '–°–µ—Ä–≤–µ—Ä –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ',
      BadRequestFailure(:final message) => message ?? '–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å',
      UnauthorizedFailure() => '–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è',
      TooManyRequestsFailure(:final message) => message ?? '–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤',
      InternalServerFailure() => '–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ',
      _ => '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: ${error.toString()}'
    };
  }

  @override
  Future<void> refresh() => loadPlaces(); // –î–ª—è pull-to-refresh

  @override
  void dispose() {
    _placesState.dispose();
  }
}

abstract interface class IPlacesModel {
  ValueListenable<PlacesState> get placesStateListenable;
  
  Future<void> loadPlaces({FilterPlacesEntity? filter});
  Future<void> refresh();
  void dispose();
}
```

## üì± –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π –≤ UI

```dart
ValueListenableBuilder<PlacesState>(
  valueListenable: placesModel.placesStateListenable,
  builder: (context, state, _) {
    return switch (state) {
      
      // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
      PlacesLoadingState() => const Center(
        child: CircularProgressIndicator(),
      ),
      
      // –£—Å–ø–µ—à–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
      PlacesLoadedState(:final places) => RefreshIndicator(
        onRefresh: () => placesModel.refresh(),
        child: ListView.builder(
          itemCount: places.length,
          itemBuilder: (context, index) => PlaceCard(
            place: places[index],
            onTap: () => _navigateToDetails(context, places[index]),
          ),
        ),
      ),
      
      // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
      PlacesErrorState(:final message) => ErrorPlaceholder(
        message: message,
        onRetry: () => placesModel.loadPlaces(),
      ),
    };
  },
)
```

### üé® –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã UI –¥–ª—è —Å–µ—Ç–µ–≤—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π:

|| –°–æ—Å—Ç–æ—è–Ω–∏–µ | UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç | –î–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
|----------|-------------|-------------|---------------------|
|| **Loading** | `CircularProgressIndicator` | ‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ |
|| **Loaded** | `ListView` + `RefreshIndicator` | üîÑ Pull-to-refresh |
|| **Error** | `ErrorPlaceholder` | üîÑ –ö–Ω–æ–ø–∫–∞ "–ü–æ–≤—Ç–æ—Ä–∏—Ç—å" |
|| **Empty** | `EmptyPlaceholder` | üîç –ò–∑–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã |

---

# üìã –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

–¢–µ–ø–µ—Ä—å –ø–æ—à–∞–≥–æ–≤–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ–º —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

## üöÄ –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `pubspec.yaml` –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã:

```yaml
dependencies:
  # HTTP –∫–ª–∏–µ–Ω—Ç
  dio: ^5.4.0
  
  # REST API –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä  
  retrofit: ^4.0.3
  
  # JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
  json_annotation: ^4.8.1

dev_dependencies:
  # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞
  build_runner: ^2.4.7
  retrofit_generator: ^8.0.6
  json_serializable: ^6.7.1
```

**–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—ã:**
```bash
flutter pub get
dart run build_runner build # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è API –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏
```

## üîß –®–∞–≥ 2: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ DI —Å–∏—Å—Ç–µ–º–µ

–í —Ñ–∞–π–ª–µ `app_scope_register.dart` –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

```dart
// –°–æ–∑–¥–∞–Ω–∏–µ HTTP –∫–ª–∏–µ–Ω—Ç–∞
final dio = AppDioConfigurator().create(
  interceptors: [
    // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    if (kDebugMode) LogInterceptor(responseBody: true),
  ],
  url: ApiUrls.baseUrl,
);

// –°–æ–∑–¥–∞–Ω–∏–µ API –∫–ª–∏–µ–Ω—Ç–∞
final apiClient = ApiClientRemote(dio);

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
final placesRepository = PlacesRepository(
  apiClient: apiClient, // –ó–∞–º–µ–Ω—è–µ–º ApiClientFromAssets –Ω–∞ ApiClientRemote
  filterStorage: filterStorage,
  filterPlacesConverter: filterPlacesConverter,
  placeResponseConverter: placeResponseConverter,
);
```

## üì° –®–∞–≥ 3: –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π API —Å–µ—Ä–≤–µ—Ä:

> üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞:** –í –ø—Ä–æ–µ–∫—Ç–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –∏–ª–∏ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å API

```bash
# –ï—Å–ª–∏ –µ—Å—Ç—å Docker
docker run -p 8888:8888 places-api-server

# –ò–ª–∏ –∑–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–æ–µ–∫—Ç–∞)
npm start # –∏–ª–∏ python app.py, –∏–ª–∏ go run main.go
```

## ‚úÖ –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

|| –ü—Ä–æ–≤–µ—Ä–∫–∞ | –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç | –ß—Ç–æ —Å–º–æ—Ç—Ä–∏–º |
|---------|---------------------|-------------|-------------|
|| **üîÑ –ó–∞–≥—Ä—É–∑–∫–∞** | –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä | `CircularProgressIndicator` |
|| **üìä –î–∞–Ω–Ω—ã–µ** | –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –º–µ—Å—Ç–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞ | –°–ø–∏—Å–æ–∫ –Ω–µ –ø—É—Å—Ç–æ–π |
|| **üåê –°–µ—Ç—å** | –ó–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è | –õ–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ |
|| **üö® –û—à–∏–±–∫–∏** | –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è | –ü—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞ |

## üîß –®–∞–≥ 5: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∑–∞–≥—Ä—É–∑–∫–∏

–û–±–Ω–æ–≤–∏—Ç–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π:

```dart
// –í PlaceCard –¥–æ–±–∞–≤—å—Ç–µ skeleton loader
class PlaceCard extends StatelessWidget {
  final PlaceEntity? place; // –ú–æ–∂–µ—Ç –±—ã—Ç—å null –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏
  
  @override
  Widget build(BuildContext context) {
    if (place == null) {
      return SkeletonPlaceCard(); // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º skeleton
    }
    
    return Card(
      child: ListTile(
        leading: CachedNetworkImage(
          imageUrl: place!.images.first,
          placeholder: (_, __) => ShimmerBox(),
          errorWidget: (_, __, ___) => Icon(Icons.error),
        ),
        title: Text(place!.name),
        subtitle: Text(place!.description),
      ),
    );
  }
}
```

---

# üéØ –ó–∞–¥–∞–Ω–∏—è –¥–ª—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã

## üñ•Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π –≤–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π –±–µ–∫–µ–Ω–¥:

**üìç –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –±–µ–∫–µ–Ω–¥–∞:** https://github.com/surfstudio/flutter-course-backend

**üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞:**
1. –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –±–µ–∫–µ–Ω–¥–∞
2. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –ø–æ –∑–∞–ø—É—Å–∫—É –≤ README —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è  
3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É `http://localhost:8888`

---

## üü¢ –ó–∞–¥–∞–Ω–∏–µ –Ω–∞ –æ—Ü–µ–Ω–∫—É "3" *(–±–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å)*

> **üé® –†–µ—Ñ–µ—Ä–µ–Ω—Å:** –í—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —ç–∫—Ä–∞–Ω—ã —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã, —Ñ–æ–∫—É—Å –Ω–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å–µ—Ç—å—é

**üéØ –¶–µ–ª—å:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—É—é —Ä–∞–±–æ—Ç—É —Å —Å–µ—Ç–µ–≤—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏

### üìã –ó–∞–¥–∞—á–∏ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
1. –†–µ–∞–ª–∏–∑—É–π—Ç–µ `AppDioConfigurator` —Å —Ç–∞–π–º–∞—É—Ç–∞–º–∏ 30 —Å–µ–∫
2. –°–æ–∑–¥–∞–π—Ç–µ `ApiClientRemote` —Å –º–µ—Ç–æ–¥–∞–º–∏ `getPlaces()` –∏ `getPlaceDetails()`
3. –ó–∞–º–µ–Ω–∏—Ç–µ `ApiClientFromAssets` –Ω–∞ `ApiClientRemote` –≤ DI —Å–∏—Å—Ç–µ–º–µ
4. –î–æ–±–∞–≤—å—Ç–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —ç–∫—Ä–∞–Ω—ã —Å —Å–µ—Ç–µ–≤—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏

---

## üü° –ó–∞–¥–∞–Ω–∏–µ –Ω–∞ –æ—Ü–µ–Ω–∫—É "4" *(–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å)*

**üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º:**

### üìã –ó–∞–¥–∞—á–∏ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
1. –î–æ–±–∞–≤—å—Ç–µ `RefreshIndicator` –Ω–∞ —ç–∫—Ä–∞–Ω—ã —Å–æ —Å–ø–∏—Å–∫–∞–º–∏
2. –°–æ–∑–¥–∞–π—Ç–µ `FilterPlacesRequestDto` —Å JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π
3. –†–µ–∞–ª–∏–∑—É–π—Ç–µ POST —ç–Ω–¥–ø–æ–∏–Ω—Ç `getFilteredPlaces()` –≤ API –∫–ª–∏–µ–Ω—Ç–µ
4. –°–æ–∑–¥–∞–π—Ç–µ `IFilterStorage` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ñ–∏–ª—å—Ç—Ä–æ–≤
5. –û–±–Ω–æ–≤–∏—Ç–µ `PlacesRepository` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
6. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —ç–∫—Ä–∞–Ω —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∫ –±–µ–∫–µ–Ω–¥—É (–Ω–µ –ª–æ–∫–∞–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)

<details>
<summary>üí° <strong>–ü–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è —É—Ä–æ–≤–Ω—è "4"</strong></summary>



## üî¥ –ó–∞–¥–∞–Ω–∏–µ –Ω–∞ –æ—Ü–µ–Ω–∫—É "5" *(—ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å)*

**üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∫ –ø—Ä–µ–¥—ã–¥—É—â–∏–º —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º:**

### üìã –û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏:
1. –°–æ–∑–¥–∞–π—Ç–µ –∫–ª–∞—Å—Å—ã —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–æ–∫ (`NoNetworkFailure`, `ServerNotRespondingFailure`, etc.)
2. –†–µ–∞–ª–∏–∑—É–π—Ç–µ `unwrapDioException()` –¥–ª—è –º–∞–ø–ø–∏–Ω–≥–∞ HTTP –∫–æ–¥–æ–≤ –≤ —Ç–∏–ø—ã –æ—à–∏–±–æ–∫
3. –°–æ–∑–¥–∞–π—Ç–µ UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—à–∏–±–æ–∫ (`ErrorPlaceholder`)
4. –û–±–Ω–æ–≤–∏—Ç–µ –≤—Å–µ Model –∫–ª–∞—Å—Å—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
5. –†–µ–∞–ª–∏–∑—É–π—Ç–µ `ApiRetryInterceptor` —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
6. –î–æ–±–∞–≤—å—Ç–µ graceful degradation –Ω–∞ –≤—Å–µ —ç–∫—Ä–∞–Ω—ã

